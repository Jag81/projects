<div id=D__ID>
    <div>
        <div id=toolbar__ID class="navbar navbar-default">
            <form class="form-inline">
                <!--<button id=load__ID type=button class="btn btn-secondary" title='Load'>Load Code</button>-->
                Site path:&nbsp <input id=path__ID type=textpassword title='Path' style='width:320px'  />&nbsp
                <button id=load__ID type=button class="btn btn-secondary" title='Load'>Load</button>
            </form>
        </div>
        <div id=tree__ID>
        </div>
        <div id=mlist__ID>
        </div>
        <div id=nodejs style='padding:50px;font-size:11px'>
            This directory tree only works under node.js server.<br>
            <a target=_blank style='color:#000' href="https://github.com/vmiis/projects/blob/master/README.md">Click here to see how to run the labs on a local computer under node.js server</a><br>
            </script>
        </div>
    </div>
    <script>
        function F__ID(){
            var editor=null;
            var file_url="";
            var module_name="";
            //--------------------------------------------------------
            $('#D__ID').on('load',function(){
                //$('#path__ID').val("labs\\002");
                var aa=window.location.href.split('?path=');
                if(aa.length=2){
                    var endpoint=window.location.protocol+"//"+window.location.hostname+":"+window.location.port;
                    var path=aa[1].replace(endpoint,'');
                    $('#path__ID').val(path);
                    $('#load__ID').triggerHandler('click');
                    show_module_list(aa[1],path);
                }
            })
            var show_module_list=function(s_id,path){
                var mL=localStorage.getItem("__temp1001_"+s_id);
                if(mL!=null && mL!=undefined){
                    var jmL=JSON.parse(mL)
                    var txt="Module list<br>";
                    var s=[];
                    var endpoint=window.location.protocol+"//"+window.location.hostname+":"+window.location.port;
                    for(a in jmL){
                        pps=jmL[a].url.split(path)
                        var pp=pps[0];
                        if(pps.length==2) pp=pps[1];
                        s.push("<a href="+path+"/"+pp+">"+a+"</a>: "+JSON.stringify(jmL[a]));
                    }
                    s.sort();
                    for(i in s){
                        txt+="&nbsp;&nbsp;&nbsp;"+s[i]+"<br>";
                    }
                    $('#mlist__ID').html(txt)
                    $('#mlist__ID a').on('click',function(e){
                    e.preventDefault();
                    var href=$(this).attr("href");
                    window.open("../editor/index.html?path="+href);
                });
                }
            }
            //--------------------------------------------------------
            $vm.module_list["__MODULE__"].show=function(){
                document.title="Directory Tree | "+$vm.default_title;
                $("meta[name='description']").attr("content","Editor");
            }
            //--------------------------------------------------------
            var ready1=function(){
            }
            //--------------------------------------------------------
            ready1();
            //--------------------------------------------------------
            var get_space=function(N){
                var txt="";
                for(var i=0;i<N;i++){
                    txt+="&nbsp;&nbsp;&nbsp;&nbsp;";
                }
                return txt;
            }
            //--------------------------------------------------------
            var get_tree=function(I,tree){
                var txt="";
                txt+=get_space(I)+tree.name+"<br>";
                for(i in tree.children){
                    if(tree.children[i].type=="directory"){
                        txt+=get_tree(I+1,tree.children[i])
                    }
                    else txt+=get_space(I+1)+"<a href="+tree.children[i].path+">"+tree.children[i].name+"</a>"+"<br>";
                }
                return txt;
            }
            //--------------------------------------------------------
            var display_tree=function(tree){
                var txt="Directory tree<br>";//<pre><code>";
                txt+=get_tree(1,tree);
                txt+="";//</code></pre>";
                $('#tree__ID').html(txt);
                $('#tree__ID a').on('click',function(e){
                    e.preventDefault();
                    var href=$(this).attr("href");
                    window.open("../editor/index.html?path="+href);
                });
            }
            //--------------------------------------------------------
            $('#load__ID').on('click',function(){
                var endpoint=window.location.protocol+"//"+window.location.hostname+":"+window.location.port;
                var path=$('#path__ID').val();
                if(path==""){
                    $vm.alert("No file path.");
                    return;
                }
                var d={cmd:'tree',"path":path}
                var da=JSON.stringify(d);
                var xmlHttp = new XMLHttpRequest();
                xmlHttp.onreadystatechange = function () {
                    console.log(this.readyState+" "+this.status);
                    if (this.readyState == 4 && this.status == 200){
                        if(this.responseText!="") display_tree(JSON.parse(this.responseText));
                    }
                    $('#nodejs').hide
                }
                xmlHttp.open("POST", endpoint, true);
                xmlHttp.send(da);
            })
            //--------------------------------------------------------
        }
    </script>
    <style>
        #D__ID{
            background-color:#fff;
            animation: vm_module_fadein 1.0s;
        }
        #toolbar__ID{
            background-color:#aaa;
            padding:5px 10px;
            margin-bottom:0px;
            overflow:hidden
        }
        #toolbar__ID button{
            margin-right:8px; 
        }
        #tree__ID{
            padding:20px;
        }
        #tree__ID a:link {
            color:#555;
        }
        #tree__ID a:visited {
            color:#555;
        }
        #tree__ID a:hover {
            color:red;
        }
        #tree__ID a:active {
            color:#555;
        }
        
        #mlist__ID{
            padding:20px;
        }
        #mlist__ID a:link {
            color:#555;
        }
        #mlist__ID a:visited {
            color:#555;
        }
        #mlist__ID a:hover {
            color:red;
        }
        #mlist__ID a:active {
            color:#555;
        }
    </style>
</div>